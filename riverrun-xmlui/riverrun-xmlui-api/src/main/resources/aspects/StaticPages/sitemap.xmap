<?xml version="1.0" encoding="UTF-8"?>
<!--
  sitemap.xmap
-->

<!--
  A simple aspect for viewing (relatively) static content added to DSpace (help
  pages, etc.)
-->

<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">
    <map:components>
        <map:transformers>
            <map:transformer name="HelpViewer"           src="ca.unb.lib.riverrun.app.xmlui.aspect.staticpages.HelpViewer"/>
            <map:transformer name="DefaultLicenseViewer" src="ca.unb.lib.riverrun.app.xmlui.aspect.staticpages.DefaultLicenseViewer"/>
        </map:transformers>
    </map:components>

    <map:pipelines>
        <map:pipeline>

            <map:generate/>

            <map:match pattern="help">
                <!-- Add page metadata, customize trail -->
                <map:transform type="HelpViewer"/>

                <!-- DSpacePropertyFileReader will read the DSpace property file
                and place the selected properties' value in this scope -->
                <map:act type="DSpacePropertyFileReader">
                    <map:parameter name="dspace.dir" value="dspace.dir" />
                    <map:transform type="Include" src="file://{dspace.dir}/config/help-xmlui.xml" />
                </map:act>
                                
                <map:serialize type="xml"/>
            </map:match>

                <!-- "license" : verb, used in DSpace code -->
                <!-- "licence" : noun, used in UI -->
            <map:match pattern="help/default-licence">
                <!-- Add page metadata, customize trail, display default licence -->
                <map:transform type="DefaultLicenseViewer"/>
                <map:serialize type="xml"/>
            </map:match>
            
            <!-- Not a URL we care about, so just pass it on. -->
            <map:serialize type="xml"/>
                        
        </map:pipeline>
    </map:pipelines>
</map:sitemap>
